<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <title>CINEMA DEBUG MODE</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #121212; color: #fff; font-family: sans-serif; text-align: center; }
        .box { background: #1e1e1e; padding: 20px; border-radius: 10px; margin: 10px auto; width: 80%; max-width: 500px; border: 1px solid #333; }
        input { padding: 10px; width: 70%; margin-bottom: 10px; background: #000; color: #fff; border: 1px solid #555; }
        button { padding: 10px 20px; cursor: pointer; font-weight: bold; border: none; border-radius: 5px; }
        .btn-h { background: #2ecc71; color: #000; }
        .btn-g { background: #3498db; color: #fff; }
        #log { font-family: monospace; font-size: 12px; color: #aaa; text-align: left; padding: 10px; background: #000; border-radius: 5px; height: 100px; overflow-y: auto; margin-top: 10px; }
        video { width: 90%; max-width: 800px; background: #000; margin-top: 20px; border: 2px solid #2ecc71; }
    </style>
</head>
<body>

    <h1>ðŸŽ¬ Cinema Debugger</h1>

    <div class="box">
        <strong>1. HOST (Ti)</strong><br>
        <input type="text" id="myId" placeholder="Ime (npr: lule123)">
        <button class="btn-h" onclick="startHost()">KREIRAJ</button>
    </div>

    <div class="box">
        <strong>2. GOST (Drugar)</strong><br>
        <input type="text" id="targetId" placeholder="Ime hosta">
        <button class="btn-g" onclick="startGuest()">POVEÅ½I SE</button>
    </div>

    <div class="box">
        <strong>STATUS KONZOLA:</strong>
        <div id="log">Sistem spreman...</div>
    </div>

    <video id="v" autoplay playsinline controls></video>

<script>
    const log = (msg) => { document.getElementById('log').innerHTML += "<br>> " + msg; };
    let peer = null;

    const peerCfg = {
        config: { 'iceServers': [{ 'urls': 'stun:stun.l.google.com:19302' }] },
        debug: 3 // Ovo Ä‡e nam reÄ‡i sve u konzoli
    };

    async function startHost() {
        const id = document.getElementById('myId').value;
        if(!id) return alert("Unesi ime!");
        
        peer = new Peer(id, peerCfg);
        log("Inicijalizacija hosta: " + id);

        peer.on('open', async () => {
            log("Soba otvorena! ÄŒekam drugara...");
            try {
                const stream = await navigator.mediaDevices.getDisplayMedia({ video: true, audio: true });
                document.getElementById('v').srcObject = stream;
                log("Strim pokrenut. Podeli link drugaru.");
                
                peer.on('call', call => {
                    log("Drugar te zove! Å aljem sliku...");
                    call.answer(stream);
                });
            } catch(e) { log("GreÅ¡ka kod deljenja: " + e); }
        });

        peer.on('error', e => log("PEER GREÅ KA: " + e.type));
    }

    function startGuest() {
        const tid = document.getElementById('targetId').value;
        log("PokuÅ¡avam da naÄ‘em: " + tid);
        
        peer = new Peer(peerCfg);
        
        peer.on('open', () => {
            const call = peer.call(tid, null);
            log("Poziv poslat...");

            call.on('stream', s => {
                log("SLIKA STIGLA! UÅ¾ivaj.");
                document.getElementById('v').srcObject = s;
            });

            // Ako se ne javi za 10 sekundi
            setTimeout(() => { if(!document.getElementById('v').srcObject) log("Nema odgovora od hosta. Proveri ime."); }, 10000);
        });

        peer.on('error', e => log("GREÅ KA KOD GOSTA: " + e.type));
    }
</script>
</body>
</html>
